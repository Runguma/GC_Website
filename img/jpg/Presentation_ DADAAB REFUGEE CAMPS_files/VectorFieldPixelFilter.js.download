// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.36/esri/copyright.txt for details.
//>>built
define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../lang dojo/_base/array".split(" "),function(y,t,C,D,p,u){return y(null,{declaredClass:"esri.layers.pixelFilters.VectorFieldPixelFilter",speedUnits:["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"],constructor:function(b){t.mixin(this,b);this.isDataUV=b&&b.isDataUV?b.isDataUV:!1;this.computeMagnitudeAndDirection=t.hitch(this,this.computeMagnitudeAndDirection);this.unitConversionFactor=
1;this._updateUnitConvFactor()},setUnits:function(b,a){this.inputUnit=b;this.outputUnit=a;this.unitConversionFactor=1;this._updateUnitConvFactor()},_updateUnitConvFactor:function(){var b=u.indexOf(this.speedUnits,this.inputUnit),a=u.indexOf(this.speedUnits,this.outputUnit);if(this.inputUnit&&this.outputUnit&&0<=b&&0<=a){var c=[1,.277778,.514444,.3048,.44704,0];this.unitConversionFactor=c[b]/c[a]}},computeMagnitudeAndDirection:function(b){if(!p.isDefined(b))throw"Could not compute magnitude and direction. No pixel data is available.";
var a=b.pixelBlock;if(!p.isDefined(a)||2!==a.getPlaneCount())throw"Could not compute magnitude and direction. Pixel data does not contain two bands.";var c=b.extent,v=(c.xmax-c.xmin)/a.width,w=(c.ymax-c.ymin)/a.height,z=c.xmin+v/2;c=c.ymax-w/2;a.statistics[0].minValue=0;a.statistics[0].maxValue=0;var A=180/Math.PI,x=[],g=0,h=0,d=0,B=!p.isDefined(a.mask),k,l,m,n;var q=m=Infinity;var r=n=-Infinity;for(g=0;g<a.height;g++)for(h=0;h<a.width;h++,d++)if(x.push([z+v*h,c-w*g]),B||a.mask[d]){var e=k=a.pixels[0][d];
var f=l=a.pixels[1][d];this.isDataUV&&(e=Math.sqrt(k*k+l*l),f=90-A*Math.atan2(l,k));a.pixels[0][d]=e*this.unitConversionFactor;a.pixels[1][d]=f;e>r&&(r=e);e<q&&(q=e);f>n&&(n=f);f<m&&(m=f)}a.statistics[0].maxValue=r;a.statistics[0].minValue=q;a.statistics[1].maxValue=n;a.statistics[1].minValue=m;b.locations=x;return b}})});